<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Dashboard - Zhee Hong FX Trading</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#0C1218',      // Very dark background
                        'secondary-dark': '#151F28',    // Card/panel background
                        'accent-green': '#10b981',      // Buy/Profit color
                        'accent-red': '#ef4444',        // Sell/Loss color
                        'secondary-gold': '#FFD700',    // Brand accent/Active
                        'gray-text': '#9CA3AF',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Custom CSS for Menu and Scrollbar */
        .sidebar {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .scroll-container::-webkit-scrollbar {
            width: 8px;
        }
        .scroll-container::-webkit-scrollbar-thumb {
            background-color: #374151;
            border-radius: 10px;
        }
        .scroll-container::-webkit-scrollbar-track {
            background: #1f2937;
        }
        .menu-item {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            color: #9CA3AF;
            transition: all 0.2s;
        }
        .menu-item:hover {
            background-color: #1f2937;
            color: white;
        }
        
        /* Banner Animation Keyframes */
        @keyframes fadeAndPulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.005); }
        }
        .pulsing-ad {
            animation: fadeAndPulse 4s infinite ease-in-out;
        }

        .invest-button {
            transition: all 0.2s ease-in-out;
        }
        .invest-button:hover {
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transform: translateY(-2px);
        }
        /* Ensure canvas fully fills its container */
        #forexChartCanvas {
            width: 100%;
            height: 100%;
            display: block; 
        }
    </style>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-primary-dark font-sans text-white min-h-screen overflow-x-hidden">

    <!-- Hamburger Menu (Sidebar) -->
    <div id="sidebar" class="sidebar fixed top-0 left-0 w-64 h-full bg-secondary-dark z-50 shadow-2xl overflow-y-auto scroll-container lg:static lg:w-64 lg:transform-none">
        <div class="p-6">
            <!-- Menu Header with Close Button -->
            <div class="flex justify-between items-center mb-8 border-b border-gray-700 pb-4">
                <h2 class="text-2xl font-extrabold text-secondary-gold">
                    <i class="fas fa-lock text-accent-green mr-2"></i> USERS PROFILE MENU
                </h2>
                <!-- Close Button (Visible when open on mobile) -->
                <button id="menuClose" class="lg:hidden text-gray-400 text-xl p-2 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <ul class="space-y-3">
                <!-- User Specifics -->
                <li><a href="profile.html" class="menu-item"><i class="fas fa-user mr-3"></i> User Profile</a></li>
                <li><a href="referrals.html" class="menu-item"><i class="fas fa-share-alt mr-3"></i> Referrals</a></li>
                <li><a href="dashboard.html" class="menu-item"><i class="fas fa-tachometer-alt mr-3"></i> Dashboard</a></li>
                <li class="border-t border-gray-700 pt-3"></li>
                <!-- Financials -->
                <li><a href="wallet.html" class="menu-item"><i class="fas fa-wallet mr-3"></i> Wallet</a></li>


                <li><a href="charts.html" class="menu-item"><i class="fas fa-wallet mr-3"></i> Forex Trade Terminal</a></li>

                <li><a href="assets.html" class="menu-item"><i class="fas fa-money-bill-alt mr-3"></i> Assets</a></li>

                <li><a href="withdraw.html" class="menu-item text-accent-red hover:text-red-400"><i class="fas fa-arrow-down mr-3"></i> Withdraw</a></li>
                <li><a href="deposit.html" class="menu-item text-accent-green hover:text-green-400"><i class="fas fa-arrow-up mr-3"></i> Deposit</a></li>

                <li class="border-t border-gray-700 pt-3"></li>
                <!-- Marcus Zee AI Features -->
                <li><a href="marcus.html" class="menu-item font-bold text-secondary-gold"><i class="fas fa-robot mr-3"></i> Marcus Zee A.I</a></li>
                <li><a href="invest_list.html" class="menu-item"><i class="fas fa-list-ul mr-3"></i> Marcus Zee Invest List</a></li>



                <li><a href="forex_trading.html" class="menu-item"><i class="fas fa-chart-line mr-3"></i> Forex Trading by Marcus</a></li>
                <li class="border-t border-gray-700 pt-3"></li>


<li><a href="voice.html" class="menu-item"><i class="fas fa-chart-line mr-3"></i> Talk To Maria A.I</a></li>
                <li class="border-t border-gray-700 pt-3"></li>



                <!-- Company & Info -->
                <li><a href="about_marcus.html" class="menu-item"><i class="fas fa-info-circle mr-3"></i> About Marcus Zee</a></li>
                <li><a href="focus.html" class="menu-item"><i class="fas fa-bullseye mr-3"></i> Our Focus</a></li>
                <li><a href="sponsor.html" class="menu-item"><i class="fas fa-handshake mr-3"></i> Sponsor</a></li>
                <li><a href="partners.html" class="menu-item"><i class="fas fa-users mr-3"></i> Partners</a></li>
                <li><a href="awards.html" class="menu-item"><i class="fas fa-trophy mr-3"></i> Awards</a></li>
                <li><a href="ceo.html" class="menu-item"><i class="fas fa-user-tie mr-3"></i> Founder and CEO</a></li>
                <li class="border-t border-gray-700 pt-3"></li>
                <!-- Support & Social -->
                <li><a href="mailto:imarket247weekly@gmail.com" class="menu-item"><i class="fas fa-envelope mr-3"></i> Marcus Zee Direct Mail</a></li>



                <li><a href="support.html" class="menu-item"><i class="fas fa-headphones mr-3"></i> Custom Support</a></li>


<li><a href="regulated.html" class="menu-item"><i class="fas fa-headphones mr-3"></i> âš“Regulated</a></li>



<li><a href="faq.html" class="menu-item"><i class="fas fa-headphones mr-3"></i> ðŸ§ FAQ</a></li>




                <li><a href="https://www.facebook.com/profile.php?id=61584454134265" class="menu-item"><i class="fab fa-facebook mr-3"></i> Facebook Account</a></li>
                
                <!-- Logout -->
                <li><a href="login.html" onclick="logout()" class="menu-item text-gray-400 hover:text-white"><i class="fas fa-sign-out-alt mr-3"></i> Log Out</a></li>
            </ul>
        </div>
    </div>

    <!-- Main Content Wrapper -->
    <div id="mainContent" class="lg:ml-64 transition-all duration-300 min-h-screen">

        <!-- Header/Account Bar -->
        <header class="bg-secondary-dark shadow-lg sticky top-0 z-40">
            <div class="px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
                
                <!-- Hamburger Button (Mobile) -->
                <button id="menuToggle" class="lg:hidden text-white text-xl p-2 rounded-lg hover:bg-gray-700">
                    <i class="fas fa-bars"></i>
                </button>
                
                <!-- Logo/Title -->
                <span class="text-white text-2xl font-bold tracking-tight hidden sm:block">ZHC USERS Dashboard</span>

                <!-- User Account Balance & Action Buttons -->
                <div class="flex items-center space-x-3 text-right">
                    
                    <!-- Deposit Button -->
                    <a href="deposit.html" class="bg-accent-green hover:bg-green-600 text-primary-dark font-semibold py-2 px-3 rounded-lg text-xs sm:text-sm transition duration-150 shadow-md whitespace-nowrap">
                        <i class="fas fa-plus mr-1"></i> Deposit
                    </a>

                    <!-- Withdraw Button -->
                    <a href="withdraw.html" class="bg-accent-red hover:bg-red-600 text-white font-semibold py-2 px-3 rounded-lg text-xs sm:text-sm transition duration-150 shadow-md whitespace-nowrap">
                        <i class="fas fa-minus mr-1"></i> Withdraw
                    </a>

                    <!-- Balance Display -->
                    <div class="flex items-center space-x-2 bg-gray-800 p-2 rounded-xl shadow-inner border border-secondary-gold">
                        <div class="text-sm font-medium text-gray-400 flex items-center">
                            <i class="fas fa-wallet text-secondary-gold mr-2"></i>
                            Balance:
                        </div>
                        <span id="currentBalance" class="text-lg font-extrabold text-accent-green">$0.00</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Dynamic Forex Chart Simulator (New Location: Immediately after Header) -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4 pb-8">
            <div class="bg-secondary-dark rounded-xl p-6 shadow-2xl border-l-4 border-accent-green">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold">EUR/USD Candlestick Chart (M5)</h3>
                    <div class="flex items-center space-x-2">
                        <span class="text-3xl font-extrabold transition duration-200" id="forexPrice">1.08345</span>
                        <span id="forexChange" class="text-base font-bold text-gray-400">(0.00%)</span>
                    </div>
                </div>
                <div id="chartContainer" class="h-80 w-full bg-[#192734] rounded-lg border border-gray-700 p-2 relative overflow-hidden">
                    <canvas id="forexChartCanvas"></canvas>
                    <p class="text-gray-500 text-xs absolute bottom-1 right-3">ZHC Marcus OHLC Data - New Candle Every 1.5s</p>
                </div>
            </div>
        </div>
        <!-- End of Forex Chart -->


        <!-- Main Body Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-0">
            
            <h1 class="text-3xl font-extrabold mb-4 text-secondary-gold">Elite Investor Portal</h1>
            <p id="userNameDisplay" class="text-gray-400 mb-6">Welcome back, Investor! Your financial freedom awaits.</p>

            <!-- Withdrawal Rule Banner -->
            <a href="withdraw.html">
                <div class="pulsing-ad bg-accent-red bg-opacity-20 text-accent-red font-medium p-4 rounded-xl mb-8 border-l-4 border-accent-red shadow-2xl transition duration-300 hover:bg-opacity-30">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    **URGENT: First-Timer Withdrawal Alert!** To qualify for initial withdrawals, your first deposit must be above $500. Your immediate withdrawal limit is set to **$800**. Click to deposit now.
                </div>
            </a>

            <!-- Investment Options Section -->
            <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-700 pb-2">Marcus Zee Guaranteed Investment Plans</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                
                <!-- Investment Card Template -->
                <template id="investmentCardTemplate">
                    <div class="bg-secondary-dark rounded-xl p-6 shadow-xl flex flex-col justify-between border-t-4 hover:border-secondary-gold transition duration-300">
                        <div class="text-center mb-4">
                            <h3 class="text-xl font-extrabold mb-1 text-white plan-title"></h3>
                            <p class="text-sm text-gray-400 plan-duration"></p>
                        </div>
                        <div class="space-y-3 mb-6">
                            <div class="text-center bg-gray-700/50 p-3 rounded-lg">
                                <p class="text-gray-text text-sm">Invest:</p>
                                <p class="text-lg font-bold text-accent-green plan-invest-range"></p>
                            </div>
                            <div class="text-center bg-gray-700/50 p-3 rounded-lg">
                                <p class="text-gray-text text-sm">Estimated Payout:</p>
                                <p class="text-xl font-extrabold text-secondary-gold plan-withdraw-range"></p>
                            </div>
                        </div>
                        <a href="deposit.html" class="invest-button w-full text-center bg-secondary-gold text-primary-dark font-bold py-3 rounded-lg hover:bg-yellow-400">
                            Invest Now
                        </a>
                    </div>
                </template>
                
            </div>
            
            <!-- Invest 4 Me Plan (Highlight) -->
            <div class="mt-12">
                <div class="bg-secondary-dark rounded-xl p-8 shadow-2xl border-4 border-secondary-gold text-center">
                    <h2 class="text-3xl font-extrabold text-secondary-gold mb-2">Invest 4 Me - 3 Year Plan</h2>
                    <p class="text-gray-400 text-lg mb-4">Let Marcus Zee A.I. manage your capital for unparalleled long-term growth.</p>
                    <p class="text-5xl font-extrabold text-accent-green mb-6">
                        <span class="text-3xl text-gray-400">+</span>10,000% ROI <span class="text-2xl text-white">Guaranteed</span>
                    </p>
                    <a href="deposit.html" class="invest-button inline-block bg-accent-green text-primary-dark font-bold py-4 px-8 rounded-full text-xl hover:bg-green-400 transition duration-150">
                        Enroll Now & Secure Future
                    </a>
                </div>
            </div>
            
            <!-- Cryptocurrency List (New Location: Before Footer) -->
            <div class="mt-12 mb-8">
                <h2 class="text-2xl font-bold text-white mb-6 border-b border-gray-700 pb-2">Top Cryptocurrency Movers</h2>
                <div class="bg-secondary-dark rounded-xl p-6 shadow-xl border-l-4 border-secondary-gold">
                    <div id="cryptoList" class="space-y-3 scroll-container max-h-96 overflow-y-auto pr-2">
                        <!-- Crypto items will be injected here dynamically -->
                    </div>
                </div>
            </div>

        </main>

        <!-- Footer -->
        <footer class="bg-secondary-dark mt-12 py-8 border-t border-gray-700">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-400">
                <p>&copy; <span id="currentYear"></span> Zhee Hong Capital. All rights reserved. Trading with Marcus Zee AI is managed for guaranteed returns.</p>
                <div class="mt-4 space-x-6 text-xl">
                    <a href="#" class="hover:text-secondary-gold"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="hover:text-secondary-gold"><i class="fab fa-tiktok"></i></a>
                    <a href="mailto:imarket247weekly@gmail.com" class="hover:text-secondary-gold"><i class="fas fa-envelope"></i></a>
                    <a href="support.html" class="hover:text-secondary-gold"><i class="fas fa-headset"></i></a>
                </div>
            </div>
        </footer>

    </div>

    <!-- JavaScript for Dynamics and Logic -->
    <script>
        // --- Configuration Data ---
        const investmentPlans = [
            { title: "Weekly Return", duration: "7 Days Term", min: 500, max: 1000, roi: 0.20 },
            { title: "Bi-Weekly Amount", duration: "14 Days Term", min: 1000, max: 5000, roi: 0.45 },
            { title: "Monthly", duration: "30 Days Term", min: 5000, max: 15000, roi: 1.00 },
            { title: "3 Month Term", duration: "90 Days Term", min: 15000, max: 50000, roi: 3.50 },
            { title: "6 Month Term", duration: "180 Days Term", min: 50000, max: 100000, roi: 8.00 },
            { title: "1 Year Term", duration: "365 Days Term", min: 100000, max: 500000, roi: 20.00 },
        ];

        let cryptoPairs = [
            { name: "BTC/USD", price: 65000.00, change: 0.03 },
            { name: "ETH/USD", price: 3800.00, change: -0.015 },
            { name: "SOL/USD", price: 150.00, change: 0.05 },
            { name: "XRP/USD", price: 0.52, change: -0.005 },
            { name: "ADA/USD", price: 0.45, change: 0.02 },
        ];
        
        // Candlestick data structure: Open, High, Low, Close
        const MAX_CANDLES = 40;
        let candleHistory = [];
        let currentPrice = 1.08345;
        let initialPrice = 1.08345;

        // --- Utility Functions ---

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 2 }).format(amount);
        }
        
        function formatForexPrice(price) {
            return price.toFixed(5);
        }

        // --- Chart Simulation Functions ---

        function initializeCandleHistory() {
            // Create initial varied candles for a better starting view
            for (let i = 0; i < MAX_CANDLES; i++) {
                currentPrice += (Math.random() - 0.5) * 0.0001;
                candleHistory.push({
                    open: currentPrice,
                    high: currentPrice + 0.00005,
                    low: currentPrice - 0.00005,
                    close: currentPrice + (Math.random() - 0.5) * 0.0001
                });
            }
            currentPrice = candleHistory[candleHistory.length - 1].close;
        }

        function generateNewCandle() {
            // Remove the oldest candle
            if (candleHistory.length >= MAX_CANDLES) {
                candleHistory.shift();
            }

            const lastClose = candleHistory.length > 0 ? candleHistory[candleHistory.length - 1].close : currentPrice;
            const volatility = 0.00015;
            
            const open = lastClose + (Math.random() - 0.5) * volatility * 0.1;
            const bias = (Math.random() < 0.5) ? -1 : 1;
            const closeChange = (Math.random() * volatility * 1.5) * bias;
            let close = open + closeChange;

            const bodyMin = Math.min(open, close);
            const bodyMax = Math.max(open, close);

            const highWick = Math.random() * volatility * 0.7;
            const lowWick = Math.random() * volatility * 0.7;

            const high = bodyMax + highWick;
            const low = bodyMin - lowWick;

            currentPrice = close;
            const newCandle = { open, high, low, close };
            candleHistory.push(newCandle);

            updateForexUi(open, close);
            
            // Use requestAnimationFrame for smooth redrawing
            requestAnimationFrame(drawCandlestickChart);
        }

        function updateForexUi(open, close) {
            const priceElement = document.getElementById('forexPrice');
            const changeElement = document.getElementById('forexChange');

            const isBullish = close > open;
            const color = isBullish ? 'var(--tw-colors-accent-green)' : 'var(--tw-colors-accent-red)';
            const totalChange = ((currentPrice - initialPrice) / initialPrice) * 100;
            
            priceElement.textContent = formatForexPrice(currentPrice);
            priceElement.style.color = color;
            
            changeElement.textContent = `${totalChange >= 0 ? '+' : ''}${totalChange.toFixed(2)}%`;
            changeElement.className = `text-base font-bold ${isBullish ? 'text-accent-green' : 'text-accent-red'}`;

        }

        function drawCandlestickChart() {
            const canvas = document.getElementById('forexChartCanvas');
            const container = document.getElementById('chartContainer');
            if (!canvas || !container) return;

            // FIX: Explicitly set canvas size based on container client dimensions
            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight; 
            
            if (containerWidth === 0 || containerHeight === 0) {
                // Fallback dimensions if container is not rendered yet, though Tailwind should handle this.
                canvas.width = 600; 
                canvas.height = 320;
            } else {
                canvas.width = containerWidth;
                canvas.height = containerHeight;
            }
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (candleHistory.length === 0) return;

            // Find max and min price across the visible candles
            const visibleCandles = candleHistory.slice(-MAX_CANDLES);
            let maxPrice = -Infinity;
            let minPrice = Infinity;

            visibleCandles.forEach(c => {
                maxPrice = Math.max(maxPrice, c.high);
                minPrice = Math.min(minPrice, c.low);
            });
            
            const priceRangeBuffer = (maxPrice - minPrice) * 0.05;
            maxPrice += priceRangeBuffer;
            minPrice -= priceRangeBuffer;
            const priceRange = maxPrice - minPrice;
            
            if (priceRange <= 0) return;

            // Configuration for drawing
            const padding = 10;
            const priceLabelWidth = 60; 
            const chartAreaWidth = canvas.width - (2 * padding);
            const chartAreaInnerWidth = chartAreaWidth - priceLabelWidth; 
            const chartAreaHeight = canvas.height - (2 * padding);
            
            const candleSpacing = chartAreaInnerWidth / MAX_CANDLES;
            const candleWidth = Math.max(3, candleSpacing * 0.75); // Slightly wider candles
            const gap = candleSpacing - candleWidth;
            
            const greenColor = '#10b981';
            const redColor = '#ef4444';
            const gridColor = '#FFFFFF05'; // Very subtle grid

            // Function to map price to Y-coordinate
            const getY = (price) => {
                const normalizedY = (price - minPrice) / priceRange; 
                return padding + chartAreaHeight * (1 - normalizedY);
            };
            
            // Draw horizontal grid lines (for context)
            ctx.strokeStyle = gridColor;
            ctx.lineWidth = 1;
            for (let i = 0; i <= 5; i++) {
                const y = padding + i * (chartAreaHeight / 5);
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - priceLabelWidth, y);
                ctx.stroke();
            }

            // Draw Candlesticks
            visibleCandles.forEach((candle, index) => {
                const x = padding + index * candleSpacing + (gap / 2);

                let bodyY1 = getY(candle.open);
                let bodyY2 = getY(candle.close);
                let color = candle.close >= candle.open ? greenColor : redColor;

                let bodyTop = Math.min(bodyY1, bodyY2);
                let bodyBottom = Math.max(bodyY1, bodyY2);
                let bodyHeight = Math.max(1, bodyBottom - bodyTop);

                // 1. Draw the Wick (High/Low)
                ctx.strokeStyle = color;
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(x + candleWidth / 2, getY(candle.high)); // High
                ctx.lineTo(x + candleWidth / 2, getY(candle.low));  // Low
                ctx.stroke();

                // 2. Draw the Body (Open/Close box)
                ctx.fillStyle = color;
                ctx.fillRect(x, bodyTop, candleWidth, bodyHeight);
                ctx.strokeStyle = color; 
                ctx.strokeRect(x, bodyTop, candleWidth, bodyHeight);
            });
            
            // Draw the current price line (Horizontal line)
            ctx.strokeStyle = currentPrice >= candleHistory[candleHistory.length - 2].close ? greenColor : redColor;
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]); 
            ctx.beginPath();
            const currentY = getY(currentPrice);
            ctx.moveTo(padding, currentY);
            ctx.lineTo(canvas.width - priceLabelWidth, currentY); 
            ctx.stroke();
            ctx.setLineDash([]); 

            // Draw the current price label on the right edge
            ctx.fillStyle = ctx.strokeStyle;
            ctx.fillRect(canvas.width - priceLabelWidth + 5, currentY - 7, priceLabelWidth - 10, 14); 
            ctx.fillStyle = 'white';
            ctx.font = '10px Inter';
            ctx.fillText(formatForexPrice(currentPrice), canvas.width - priceLabelWidth + 8, currentY + 3);
        }
        
        // --- Crypto Simulation Function ---
        
        function updateCryptoPrices() {
            const listContainer = document.getElementById('cryptoList');
            if (!listContainer) return;
            listContainer.innerHTML = ''; 

            cryptoPairs.forEach(pair => {
                const volatility = pair.price * 0.012; 
                const randomChange = (Math.random() - 0.5) * volatility;
                
                const oldPrice = pair.price;
                const newPrice = pair.price + randomChange;
                
                const percentageChange = ((newPrice - oldPrice) / oldPrice) * 100;
                
                pair.price = newPrice; 
                
                const colorClass = percentageChange >= 0 ? 'text-accent-green' : 'text-accent-red';
                const icon = percentageChange >= 0 ? '<i class="fas fa-caret-up"></i>' : '<i class="fas fa-caret-down"></i>';

                const item = document.createElement('div');
                item.className = 'flex justify-between items-center p-3 rounded-lg bg-gray-700/50 shadow-sm transition duration-300 ease-in-out transform hover:scale-[1.01]';
                item.innerHTML = `
                    <span class="font-medium text-white">${pair.name}</span>
                    <div class="text-right">
                        <span class="text-sm font-semibold text-gray-300">${formatCurrency(newPrice)}</span>
                        <span class="text-xs ml-2 ${colorClass} font-bold">${icon} ${Math.abs(percentageChange).toFixed(2)}%</span>
                    </div>
                `;
                listContainer.appendChild(item);
            });
        }

        // --- Investment Plan Rendering ---

        function renderInvestmentPlans() {
            const container = document.querySelector('.grid.gap-6');
            const template = document.getElementById('investmentCardTemplate');
            if (!container || !template) return;
            container.innerHTML = ''; 

            investmentPlans.forEach(plan => {
                const card = template.content.cloneNode(true);
                const roiMin = plan.min * (1 + plan.roi);
                const roiMax = plan.max * (1 + plan.roi);

                card.querySelector('.plan-title').textContent = plan.title;
                card.querySelector('.plan-duration').textContent = `Duration: ${plan.duration}`;
                
                card.querySelector('.plan-invest-range').textContent = formatCurrency(plan.min) + ' - ' + formatCurrency(plan.max);
                card.querySelector('.plan-withdraw-range').textContent = formatCurrency(roiMin) + ' - ' + formatCurrency(roiMax);
                card.querySelector('.border-t-4').classList.add('border-accent-green'); 

                if (plan.title.includes('Bi-Weekly')) {
                    card.querySelector('.border-t-4').classList.replace('border-accent-green', 'border-accent-red');
                } else if (plan.title.includes('Monthly')) {
                    card.querySelector('.border-t-4').classList.replace('border-accent-green', 'border-secondary-gold');
                }

                container.appendChild(card);
            });
        }

        // --- General App Logic ---

        function setupMenuToggle() {
            const sidebar = document.getElementById('sidebar');
            const menuToggle = document.getElementById('menuToggle');
            const menuClose = document.getElementById('menuClose');

            function toggleMenu() {
                sidebar.classList.toggle('open');
                document.getElementById('mainContent').setAttribute('aria-hidden', sidebar.classList.contains('open'));
            }

            if (menuToggle) {
                menuToggle.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleMenu();
                });
            }
            
            if (menuClose) {
                menuClose.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleMenu();
                });
            }
            
            let userName = "Investor";
            if (typeof window.__registered_user_data !== 'undefined' && Object.keys(window.__registered_user_data).length > 0) {
                 const firstUser = window.__registered_user_data[Object.keys(window.__registered_user_data)[0]];
                 if (firstUser && firstUser.firstName) {
                     userName = firstUser.firstName;
                 }
            }
            document.getElementById('userNameDisplay').textContent = `Welcome back, ${userName}! Your financial freedom awaits.`;
        }

        function logout() {
            window.location.href = 'login.html';
        }


        // --- Initialization ---

        window.onload = function() {
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            setupMenuToggle();
            renderInvestmentPlans();

            // Initialize dynamic market data
            initializeCandleHistory();
            
            // Initial draw call
            requestAnimationFrame(drawCandlestickChart);
            updateCryptoPrices();

            // Set update intervals for simulation
            // Forex updates every 1.5 seconds (generating a new candle)
            setInterval(generateNewCandle, 1500); 
            // Crypto updates every 3 seconds
            setInterval(updateCryptoPrices, 3000); 
            
            // Re-draw chart on window resize to maintain responsiveness
            window.addEventListener('resize', drawCandlestickChart);
        };

        // Add event listeners to all menu items to close the sidebar on mobile when clicked
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', () => {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('open')) {
                    sidebar.classList.remove('open');
                }
            });
        });
    </script>

</body>
</html>

