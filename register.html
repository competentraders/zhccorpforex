<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Terminal - Initialization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cyber-bg': '#05080A',
                        'cyber-card': '#0D151C',
                        'cyber-gold': '#FFD700',
                        'cyber-cyan': '#00F2FF',
                        'cyber-green': '#00FF88',
                        'cyber-red': '#FF3131',
                    },
                    fontFamily: {
                        brand: ['Orbitron', 'sans-serif'],
                        ui: ['Rajdhani', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        body { 
            font-family: 'Rajdhani', sans-serif; 
            background: radial-gradient(circle at center, #0D151C, #05080A);
            background-attachment: fixed;
        }

        .terminal-input {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(0, 242, 255, 0.2);
            color: white;
            transition: all 0.3s ease;
        }

        .terminal-input:focus {
            outline: none;
            border-color: #00F2FF;
            box-shadow: 0 0 15px rgba(0, 242, 255, 0.2);
            background: rgba(0, 242, 255, 0.05);
        }

        .neo-button {
            clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0% 30%);
            transition: all 0.3s ease;
        }

        .glass-panel {
            background: rgba(13, 21, 28, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* Custom scrollbar for nationality list */
        select option { background: #0D151C; color: white; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 sm:p-8">

    <div class="w-full max-w-2xl glass-panel relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-cyber-cyan to-transparent"></div>
        
        <div class="p-6 sm:p-10">
            <div class="text-center mb-10">
                <div class="inline-block px-3 py-1 border border-cyber-cyan/30 text-[10px] font-brand text-cyber-cyan tracking-[0.3em] uppercase mb-4">
                    New Account Protocol
                </div>
                <h1 class="text-3xl font-brand font-black text-white tracking-tighter uppercase italic">
                    Initialize <span class="text-cyber-cyan">Profile</span>
                </h1>
                <p class="text-gray-500 text-sm mt-2 uppercase tracking-widest">Access the Elite Trading Network</p>
            </div>

            <form id="registerForm" onsubmit="handleRegistration(event)" class="space-y-6">
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">First Name</label>
                        <input id="firstName" type="text" required class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Last Name</label>
                        <input id="lastName" type="text" required class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Middle</label>
                        <input id="otherName" type="text" class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Email Address</label>
                        <input id="email" type="email" required class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Confirm Email</label>
                        <input id="confirmEmail" type="email" required class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Security Password</label>
                        <input id="password" type="password" required class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Verify Password</label>
                        <input id="confirmPassword" type="password" required class="w-full p-3 terminal-input rounded-none text-sm">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Origin/Nationality</label>
                        <select id="nationality" required class="w-full p-3 terminal-input rounded-none text-sm"></select>
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Comms/Phone</label>
                        <div class="flex">
                            <input id="countryCode" type="text" value="+65" readonly class="w-20 p-3 terminal-input bg-cyber-bg/50 border-cyber-cyan/10 text-cyber-cyan font-bold text-center cursor-not-allowed">
                            <input id="phone" type="tel" required class="flex-grow p-3 terminal-input border-l-0 text-sm">
                        </div>
                    </div>
                </div>

                <div class="space-y-1">
                    <label class="text-[10px] font-brand text-gray-500 uppercase tracking-widest">Gender Identity</label>
                    <select id="gender" required class="w-full p-3 terminal-input rounded-none text-sm">
                        <option value="" disabled selected>Select...</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Non-Binary / Private</option>
                    </select>
                </div>

                <div class="p-4 border border-cyber-gold/20 bg-cyber-gold/5 relative">
                    <div class="flex flex-col sm:flex-row items-center gap-4">
                        <div id="securityCodeDisplay" class="font-brand text-2xl font-black text-cyber-green bg-black px-6 py-2 border border-cyber-green/30 tracking-widest select-none">123456</div>
                        <input id="securityCodeInput" type="text" placeholder="AUTH CODE" maxlength="6" class="w-full sm:w-32 p-3 terminal-input text-center font-bold tracking-[0.2em]">
                        <button type="button" onclick="verifySecurityCode()" id="verifyButton" class="w-full sm:w-auto px-6 py-3 bg-gray-800 text-[10px] font-brand uppercase tracking-widest hover:bg-cyber-cyan hover:text-black transition-colors">
                            Verify
                        </button>
                    </div>
                    <div id="verificationStatus" class="text-[10px] font-brand mt-2 text-gray-500 uppercase">Status: Authorization Pending...</div>
                </div>

                <div class="pt-4">
                    <button type="submit" id="submitButton" disabled class="w-full neo-button bg-gray-800 text-gray-500 font-brand font-black py-4 uppercase tracking-[0.2em] cursor-not-allowed transition-all">
                        Initialize Protocol
                    </button>
                    <p id="errorMessage" class="mt-4 text-center font-brand text-[10px] text-cyber-red font-bold uppercase hidden">Error: Invalid Sequence Detected</p>
                </div>
            </form>
            
            <div class="mt-8 text-center">
                <p class="text-xs text-gray-600 uppercase tracking-widest">Already have an account? <a href="login.html" class="text-cyber-cyan hover:underline">Log in</a></p>
            </div>
        </div>
    </div>

    <script>
        const DB_KEY = 'zhc_forex_user_db';
        let currentSecurityCode = '';
        let isCodeVerified = false;

        const countryData = [
            { name: "Singapore", code: "+65", continent: "Asia" },
            { name: "Japan", code: "+81", continent: "Asia" },
            { name: "China", code: "+86", continent: "Asia" },
            { name: "India", code: "+91", continent: "Asia" },
            { name: "UAE", code: "+971", continent: "Asia" },
            { name: "Germany", code: "+49", continent: "Europe" },
            { name: "UK", code: "+44", continent: "Europe" },
            { name: "France", code: "+33", continent: "Europe" },
            { name: "Switzerland", code: "+41", continent: "Europe" },
            { name: "USA", code: "+1", continent: "Americas" },
            { name: "Canada", code: "+1", continent: "Americas" },
            { name: "Brazil", code: "+55", continent: "Americas" },
            { name: "South Africa", code: "+27", continent: "Africa" },
            { name: "Nigeria", code: "+234", continent: "Africa" },
            { name: "Australia", code: "+61", continent: "Oceania" },
        ];

        function loadUserDB() {
            const dbString = localStorage.getItem(DB_KEY);
            return dbString ? JSON.parse(dbString) : {};
        }

        function saveUserDB(db) {
            localStorage.setItem(DB_KEY, JSON.stringify(db));
        }

        function generateSecurityCode() {
            return Math.floor(100000 + Math.random() * 900000).toString();
        }

        function updateSecurityCode() {
            currentSecurityCode = generateSecurityCode();
            document.getElementById('securityCodeDisplay').textContent = currentSecurityCode;
            isCodeVerified = false;
            document.getElementById('verificationStatus').textContent = 'Status: Authorization Pending...';
            document.getElementById('verificationStatus').className = 'text-[10px] font-brand mt-2 text-gray-500 uppercase';
            document.getElementById('submitButton').disabled = true;
            document.getElementById('submitButton').className = 'w-full neo-button bg-gray-800 text-gray-500 font-brand font-black py-4 uppercase tracking-[0.2em] cursor-not-allowed';
            document.getElementById('securityCodeInput').value = '';
        }

        function verifySecurityCode() {
            const inputCode = document.getElementById('securityCodeInput').value;
            const statusElement = document.getElementById('verificationStatus');
            const submitButton = document.getElementById('submitButton');

            if (inputCode === currentSecurityCode) {
                isCodeVerified = true;
                statusElement.textContent = 'Status: Access Granted';
                statusElement.className = 'text-[10px] font-brand mt-2 text-cyber-green uppercase font-bold';
                submitButton.disabled = false;
                submitButton.className = 'w-full neo-button bg-cyber-cyan text-black font-brand font-black py-4 uppercase tracking-[0.2em] hover:bg-white transition-all shadow-lg shadow-cyber-cyan/20';
            } else {
                isCodeVerified = false;
                statusElement.textContent = 'Status: Code Invalid';
                statusElement.className = 'text-[10px] font-brand mt-2 text-cyber-red uppercase font-bold';
                submitButton.disabled = true;
                submitButton.className = 'w-full neo-button bg-gray-800 text-gray-500 font-brand font-black py-4 uppercase tracking-[0.2em] cursor-not-allowed';
            }
        }

        function populateNationalityDropdown() {
            const select = document.getElementById('nationality');
            select.innerHTML = '<option value="" disabled selected>Select Territory</option>';
            const continents = [...new Set(countryData.map(item => item.continent))];
            continents.forEach(continent => {
                const optgroup = document.createElement('optgroup');
                optgroup.label = continent;
                countryData.filter(item => item.continent === continent).forEach(country => {
                    const option = document.createElement('option');
                    option.value = country.name;
                    option.textContent = `${country.name} (${country.code})`;
                    optgroup.appendChild(option);
                });
                select.appendChild(optgroup);
            });
            select.addEventListener('change', (e) => {
                const country = countryData.find(c => c.name === e.target.value);
                if (country) document.getElementById('countryCode').value = country.code;
            });
        }

        function handleRegistration(event) {
            event.preventDefault(); 
            const errorElement = document.getElementById('errorMessage');
            errorElement.classList.add('hidden');

            const email = document.getElementById('email').value;
            const confirmEmail = document.getElementById('confirmEmail').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (email !== confirmEmail || password !== confirmPassword) {
                errorElement.textContent = "Error: Input Mismatch";
                errorElement.classList.remove('hidden');
                return;
            }

            let db = loadUserDB();
            if (db[email]) {
                errorElement.textContent = "Error: Email Already Initialized";
                errorElement.classList.remove('hidden');
                return;
            }

            db[email] = {
                password: password,
                firstName: document.getElementById('firstName').value,
                phone: document.getElementById('countryCode').value + document.getElementById('phone').value,
                isLoggedIn: false
            };
            
            saveUserDB(db);
            window.location.href = 'Dashboard_forex.html';
        }

        window.onload = function() {
            populateNationalityDropdown();
            updateSecurityCode();
            setInterval(updateSecurityCode, 40000);
        };
    </script>
</body>
</html>
