<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Trading | ZHC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-dark: #0C1218;
            --secondary-dark: #151F28;
            --accent-green: #10b981;
            --accent-red: #ef4444;
            --secondary-gold: #FFD700;
        }
        body { background-color: var(--primary-dark); font-family: 'Inter', sans-serif; }
        .bg-primary-dark { background-color: var(--primary-dark); }
        .bg-secondary-dark { background-color: var(--secondary-dark); }
        .text-secondary-gold { color: var(--secondary-gold); }
        .text-accent-green { color: var(--accent-green); }
        .text-accent-red { color: var(--accent-red); }
        .chart-container { min-height: 400px; height: 70vh; max-height: 800px; }
    </style>
</head>
<body class="text-white min-h-screen">

    <div class="px-4 py-6 sm:px-6 lg:px-8 max-w-full mx-auto">
        <h1 class="text-3xl font-extrabold mb-6 text-secondary-gold text-center border-b border-gray-700 pb-3">Crypto Trading ZHC</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            
            <!-- Asset Selector / Watchlist (Col 1) -->
            <div class="lg:col-span-1 bg-secondary-dark p-4 rounded-xl shadow-2xl overflow-hidden">
                <h2 class="text-xl font-bold mb-4 text-white"><i class="fas fa-list-alt mr-2"></i> Watchlist</h2>
                <ul id="assetList" class="space-y-2">
                    <!-- Asset cards generated by JS -->
                </ul>
            </div>
            
            <!-- Main Chart Area (Col 2 & 3) -->
            <div class="lg:col-span-2 bg-secondary-dark p-4 rounded-xl shadow-2xl">
                <div class="flex justify-between items-center mb-4 border-b border-gray-700 pb-2">
                    <h2 id="currentAssetDisplay" class="text-2xl font-bold text-accent-green">BTC/USD</h2>
                    <div id="priceStatus" class="flex items-center space-x-2 text-lg font-mono">
                        <span id="currentPrice" class="text-white">65000.00</span>
                        <span id="priceChange" class="text-accent-green">+0.50%</span>
                    </div>
                </div>

                <div class="chart-container relative">
                    <canvas id="tradingChart" class="w-full h-full rounded-lg bg-primary-dark border border-gray-700"></canvas>
                </div>
            </div>

            <!-- Trade Execution Panel (Col 4) -->
            <div class="lg:col-span-1 bg-secondary-dark p-6 rounded-xl shadow-2xl space-y-4">
                <h2 class="text-xl font-bold text-white text-center border-b border-gray-700 pb-2">Execute Trade</h2>

                <!-- Order Type -->
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-400">Order Type</label>
                    <select class="w-full bg-primary-dark input-style border-gray-700 p-2 rounded-lg text-white">
                        <option>Market</option>
                        <option>Limit</option>
<option>Buy stop</option>
<option>Sell Stop</option>
                    </select>
                </div>

                <!-- Quantity -->
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-400">Quantity (Units)</label>
                    <input type="number" value="0.01" step="0.01" class="w-full bg-primary-dark input-style border-gray-700 p-2 rounded-lg text-white">
                </div>
                
                <p class="text-sm text-gray-500">Estimated Cost: <span id="estimatedCost">$650.00</span></p>

                <div class="pt-4 space-y-3">
                    <!-- Buy Button -->
                    <a href="deposit.html" class="w-full flex items-center justify-center py-3 bg-accent-green text-primary-dark font-extrabold rounded-lg shadow-lg hover:bg-green-600 transition duration-150">
                        <i class="fas fa-arrow-up mr-2"></i> BUY / LONG
                    </a>

                    <!-- Sell Button -->
                    <a href="deposit.html" class="w-full flex items-center justify-center py-3 bg-accent-red text-white font-extrabold rounded-lg shadow-lg hover:bg-red-600 transition duration-150">
                        <i class="fas fa-arrow-down mr-2"></i> SELL / SHORT
                    </a>
                </div>
                
                <p class="text-xs text-gray-600 text-center pt-2">Trading links redirect to Deposit page due to insufficient funds.</p>
            </div>
            
        </div>
    </div>

    <script>
        const ASSETS = [
            { symbol: 'BTC/USD', name: 'Bitcoin', price: 65000.00, start: 65000.00, color: '#f7931a' },
            { symbol: 'ETH/USD', name: 'Ethereum', price: 3500.00, start: 3500.00, color: '#627eea' },
            { symbol: 'SOL/USD', name: 'Solana', price: 150.00, start: 150.00, color: '#9945ff' },
            { symbol: 'BNB/USD', name: 'Binance Coin', price: 600.00, start: 600.00, color: '#f3ba2f' },
            { symbol: 'XRP/USD', name: 'Ripple', price: 0.5200, start: 0.5200, color: '#0062a8' },
        ];
        
        let currentAsset = ASSETS[0];
        let dataPoints = [];
        const MAX_DATA_POINTS = 100;
        let chartContext, chartCanvas;

        function initializeChart() {
            chartCanvas = document.getElementById('tradingChart');
            if (!chartCanvas) return;
            chartContext = chartCanvas.getContext('2d');
            
            function resizeCanvas() {
                const rect = chartCanvas.parentElement.getBoundingClientRect();
                chartCanvas.width = rect.width;
                chartCanvas.height = rect.height;
                drawChart();
            }

            window.addEventListener('resize', resizeCanvas);
            resizeCanvas(); 
            
            // Initialize data points for the first asset
            for (let i = 0; i < MAX_DATA_POINTS; i++) {
                dataPoints.push(currentAsset.price + (Math.random() - 0.5) * 0.0001);
            }
            
            // Start the simulation loop
            setInterval(updateSimulation, 100);
            renderAssetList();
        }

        function switchAsset(symbol) {
            const newAsset = ASSETS.find(a => a.symbol === symbol);
            if (!newAsset) return;

            currentAsset = newAsset;
            
            // Reset data points for the new asset
            dataPoints = [];
            for (let i = 0; i < MAX_DATA_POINTS; i++) {
                dataPoints.push(currentAsset.price + (Math.random() - 0.5) * 0.0001);
            }

            document.getElementById('currentAssetDisplay').textContent = symbol;
            renderAssetList(); // Update highlight
            drawChart(); // Initial draw
        }

        function updateSimulation() {
            let totalChange = 0;

            ASSETS.forEach(asset => {
                // Random walk with a slight drift back towards the start price (mean reversion)
                const drift = (asset.start - asset.price) * 0.00005;
                const volatility = asset.start > 100 ? 1 : 0.01; // Scale volatility for price size
                const change = (Math.random() - 0.5) * volatility + drift; 
                
                asset.price += change;
                totalChange += change; // Accumulate change for the current asset to update the chart
            });

            // Update the main chart if it's the currently selected asset
            if (currentAsset) {
                // If it's the current asset, update its data points
                const lastPrice = dataPoints[dataPoints.length - 1];
                const newPrice = currentAsset.price;

                dataPoints.push(newPrice);
                if (dataPoints.length > MAX_DATA_POINTS) {
                    dataPoints.shift();
                }

                // Update UI elements
                document.getElementById('currentPrice').textContent = newPrice.toFixed(currentAsset.price > 1 ? 2 : 4);
                
                // Calculate percentage change since last point (very rough)
                const percentChange = (newPrice - lastPrice) / lastPrice * 100;
                const priceChangeEl = document.getElementById('priceChange');
                priceChangeEl.textContent = `${percentChange.toFixed(2)}%`;
                
                // Color change based on price movement
                if (percentChange > 0) {
                    priceChangeEl.classList.remove('text-accent-red');
                    priceChangeEl.classList.add('text-accent-green');
                } else if (percentChange < 0) {
                    priceChangeEl.classList.remove('text-accent-green');
                    priceChangeEl.classList.add('text-accent-red');
                } else {
                    priceChangeEl.classList.remove('text-accent-red', 'text-accent-green');
                    priceChangeEl.classList.add('text-white');
                }

                document.getElementById('estimatedCost').textContent = `$${(newPrice * 0.01).toFixed(2)}`; // 0.01 units cost
            }

            // Always redraw the chart and asset list
            drawChart();
            renderAssetList();
        }


        function drawChart() {
            if (!chartContext || !chartCanvas || dataPoints.length === 0) return;

            chartContext.clearRect(0, 0, chartCanvas.width, chartCanvas.height);
            
            // Scaling calculations
            const prices = dataPoints.slice(10);
            const minPrice = Math.min(...prices);
            const maxPrice = Math.max(...prices);
            const range = maxPrice - minPrice;
            
            const paddingY = chartCanvas.height * 0.1;
            const effectiveHeight = chartCanvas.height - 2 * paddingY;
            const stepX = chartCanvas.width / (dataPoints.length - 1);
            
            // --- Draw Grid/X-Axis Labels (Simple) ---
            chartContext.fillStyle = '#374151'; // Gray-700
            chartContext.font = '10px Inter, sans-serif';
            
            // Draw price labels (Y-axis simulation)
            for (let i = 0; i <= 4; i++) {
                const y = paddingY + i * (effectiveHeight / 4);
                
                // Draw horizontal line
                chartContext.beginPath();
                chartContext.moveTo(0, y);
                chartContext.lineTo(chartCanvas.width, y);
                chartContext.strokeStyle = '#1f2937'; // Gray-800 for grid
                chartContext.stroke();
                
                // Draw price text
                const price = maxPrice - (i * range / 4);
                chartContext.fillText(price.toFixed(currentAsset.price > 1 ? 2 : 4), 5, y - 2);
            }

            // --- Draw the Line and Gradient ---
            chartContext.beginPath();
            
            dataPoints.forEach((price, index) => {
                let y = effectiveHeight - ((price - minPrice) / range) * effectiveHeight + paddingY;
                if (range < 0.00001) y = chartCanvas.height / 2;

                const x = index * stepX;

                if (index === 0) {
                    chartContext.moveTo(x, y);
                } else {
                    chartContext.lineTo(x, y);
                }
            });
            
            // Save the path for the line stroke
            chartContext.save(); 
            chartContext.strokeStyle = currentAsset.color || '#10b981';
            chartContext.lineWidth = 2;
            chartContext.stroke();
            chartContext.restore();
            
            // Create path for the gradient fill below the line
            chartContext.lineTo(chartCanvas.width, chartCanvas.height);
            chartContext.lineTo(0, chartCanvas.height);
            chartContext.closePath();
            
            const gradient = chartContext.createLinearGradient(0, 0, 0, chartCanvas.height);
            gradient.addColorStop(0, `${currentAsset.color || '#10b981'}80`); // 50% opacity
            gradient.addColorStop(1, `${currentAsset.color || '#10b981'}00`);  // 0% opacity
            chartContext.fillStyle = gradient;
            chartContext.fill();
        }
        
        function renderAssetList() {
            const assetList = document.getElementById('assetList');
            assetList.innerHTML = ASSETS.map(asset => {
                const isActive = asset.symbol === currentAsset.symbol;
                const change = ((asset.price - asset.start) / asset.start) * 100;
                const changeColor = change >= 0 ? 'text-accent-green' : 'text-accent-red';
                const changeIcon = change >= 0 ? 'fas fa-chevron-up' : 'fas fa-chevron-down';
                const activeClass = isActive ? 'border-secondary-gold ring-2 ring-secondary-gold' : 'border-gray-700 hover:border-accent-green';

                return `
                    <li onclick="switchAsset('${asset.symbol}')" class="p-3 bg-primary-dark rounded-xl shadow cursor-pointer border-2 ${activeClass} transition duration-150">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-lg">${asset.symbol}</h3>
                            <span class="text-sm ${changeColor} font-semibold">${change.toFixed(2)}% <i class="${changeIcon}"></i></span>
                        </div>
                        <p class="text-gray-400 text-sm">${asset.name}</p>
                        <p class="text-white text-xl font-mono mt-1" style="color: ${asset.color}">${asset.price.toFixed(asset.price > 1 ? 2 : 4)}</p>
                    </li>
                `;
            }).join('');
        }

        window.onload = initializeChart;
    </script>
</body>
</html>

